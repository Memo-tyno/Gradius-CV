<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gradius Style - enemy-system</title>
  <style>
    body { margin:0; display:flex; justify-content:center; align-items:center; height:100vh; background:#000; color:#0ff; font-family:monospace;}
    canvas { border:2px solid #0ff; background:linear-gradient(to bottom,#000,#002); display:block; }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <script>
  const canvas=document.getElementById("gameCanvas");
  const ctx=canvas.getContext("2d");

  const gameState={running:true,player:null,enemies:[],enemyBullets:[],bullets:[],stars:[],lastTime:0,enemySpawnTimer:0,score:0,lives:3};

  class Star{constructor(){this.reset();}reset(){this.x=Math.random()*canvas.width;this.y=Math.random()*canvas.height;this.speed=Math.random()*2+0.5;}update(dt){this.x-=this.speed*dt*60;if(this.x<-2)this.x=canvas.width+2;}draw(){ctx.fillStyle="#fff";ctx.fillRect(this.x,this.y,2,2);}}
  class Player{constructor(){this.x=100;this.y=canvas.height/2;this.speed=5;this.cooldown=0;}update(dt){if(keys["ArrowUp"]||keys["z"])this.y-=this.speed;if(keys["ArrowDown"]||keys["s"])this.y+=this.speed;this.y=Math.max(20,Math.min(canvas.height-20,this.y));this.cooldown-=dt;if(this.cooldown<=0){gameState.bullets.push(new Bullet(this.x+25,this.y,true));this.cooldown=0.2;}}draw(){ctx.fillStyle="#0ff";ctx.beginPath();ctx.moveTo(this.x+20,this.y);ctx.lineTo(this.x-20,this.y-15);ctx.lineTo(this.x-10,this.y);ctx.lineTo(this.x-20,this.y+15);ctx.closePath();ctx.fill();}}
  class Bullet{constructor(x,y,isPlayer=true){this.x=x;this.y=y;this.isPlayer=isPlayer;this.speed=isPlayer?10:5;}update(dt){this.x+=this.isPlayer?this.speed*dt*60:-this.speed*dt*60;}draw(){ctx.fillStyle=this.isPlayer?"#0ff":"#f00";ctx.fillRect(this.x-2,this.y-2,4,4);}}
  class Enemy{constructor(type=1){this.type=type;this.x=canvas.width+30;this.y=Math.random()*(canvas.height-60)+30;this.speed=1.5+Math.random();this.fireCooldown=Math.random()*2+1;}update(dt){this.x-=this.speed*dt*60;this.fireCooldown-=dt;if(this.fireCooldown<=0){this.fire();this.fireCooldown=2+Math.random();}}fire(){gameState.enemyBullets.push(new Bullet(this.x-20,this.y,false));}draw(){ctx.fillStyle="#f00";if(this.type==1)ctx.fillRect(this.x-15,this.y-15,30,30);if(this.type==2)ctx.fillRect(this.x-20,this.y-10,40,20);if(this.type==3)ctx.beginPath(),ctx.arc(this.x,this.y,15,0,Math.PI*2),ctx.fill();}}
  const keys={};
  function initStars(){for(let i=0;i<80;i++)gameState.stars.push(new Star());}
  function spawnEnemy(){const now=Date.now();if(!gameState.enemySpawnTimer)gameState.enemySpawnTimer=now;if(now-gameState.enemySpawnTimer<1000)return;gameState.enemySpawnTimer=now;const t=Math.random()<0.6?1:Math.random()<0.85?2:3;gameState.enemies.push(new Enemy(t));}
  function start(){gameState.player=new Player();initStars();gameState.lastTime=Date.now();loop();}
  function loop(){if(!gameState.running)return;const now=Date.now();const dt=(now-gameState.lastTime)/1000;gameState.lastTime=now;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    gameState.stars.forEach(s=>{s.update(dt);s.draw();});
    gameState.player.update(dt);gameState.player.draw();
    spawnEnemy();
    gameState.enemies.forEach(e=>{e.update(dt);e.draw();});
    gameState.bullets.forEach(b=>{b.update(dt);b.draw();});
    gameState.enemyBullets.forEach(b=>{b.update(dt);b.draw();});
    gameState.bullets=gameState.bullets.filter(b=>b.x<canvas.width+50);
    gameState.enemyBullets=gameState.enemyBullets.filter(b=>b.x>-50);
    gameState.enemies=gameState.enemies.filter(e=>e.x>-50);
    requestAnimationFrame(loop);
  }
  window.addEventListener("keydown",e=>keys[e.key]=true);
  window.addEventListener("keyup",e=>keys[e.key]=false);
  start();
  </script>
</body>
</html>
